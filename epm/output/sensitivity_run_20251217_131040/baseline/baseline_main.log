--- Job main.gms Start 12/17/25 13:10:46 50.1.0 12b75dde WEX-WEI x86 64bit/MS Windows
--- Applying:
    C:\GAMS\50\gmsprmNT.txt
    C:\Users\wb590499\OneDrive - WBG\Documents\GAMS\gamsconfig.yaml
--- GAMS Parameters defined
    Input C:\Users\wb590499\Documents\Projects\EPM\epm\main.gms
    ScrDir C:\Users\wb590499\Documents\Projects\EPM\epm\output\sensitivity_run_20251217_131040\baseline\225a\
    SysDir C:\GAMS\50\
    LogOption 4
    LogFile C:\Users\wb590499\Documents\Projects\EPM\epm\output\sensitivity_run_20251217_131040\baseline\baseline_main.log
    AppendLog 1
    --BASE_FILE C:\Users\wb590499\Documents\Projects\EPM\epm\base.gms
    --REPORT_FILE C:\Users\wb590499\Documents\Projects\EPM\epm\generate_report.gms
    --READER_FILE C:\Users\wb590499\Documents\Projects\EPM\epm\input_readers.gms
    --DEMAND_FILE C:\Users\wb590499\Documents\Projects\EPM\epm\generate_demand.gms
    --HYDROGEN_FILE C:\Users\wb590499\Documents\Projects\EPM\epm\hydrogen_module.gms
    --FOLDER_INPUT C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test
    --modeltype RMIP
    --cplexfile C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\cplex/cplex_baseline.opt
    --pSettings C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\pSettings.csv
    --y C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\y.csv
    --zcmap C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\zcmap.csv
    --pHours C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\pHours.csv
    --pDays C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\static/dispatch_month_days.csv
    --mapTS C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\static/dispatch_map_ts.csv
    --ftfindex C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\resources/ftfindex.csv
    --pFuelCarbonContent C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\resources/pFuelCarbonContent.csv
    --pTechData C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\resources/pTechData.csv
    --pSettingsHeader C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\resources/pSettingsHeader.csv
    --pGenDataInputHeader C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\resources/pGenDataInputHeader.csv
    --pStorageDataHeader C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\resources/pStorageDataHeader.csv
    --pTransmissionHeader C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\resources/pTransmissionHeader.csv
    --pH2Header C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\resources/pH2Header.csv
    --pDemandProfile C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\load/pDemandProfile.csv
    --pDemandData C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\load/pDemandData.csv
    --pDemandForecast C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\load/pDemandForecast.csv
    --sRelevant C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\load/sRelevant.csv
    --pEnergyEfficiencyFactor C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\load/pEnergyEfficiencyFactor.csv
    --pGenDataInput C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\supply/pGenDataInput.csv
    --pGenDataInputDefault C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\supply/pGenDataInputDefault.csv
    --pAvailability C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\supply/pAvailabilityCustom.csv
    --pAvailabilityDefault C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\supply/pAvailabilityDefault.csv
    --pEvolutionAvailability C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\supply/pEvolutionAvailability.csv
    --pCapexTrajectories C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\supply/pCapexTrajectoriesCustom.csv
    --pCapexTrajectoriesDefault C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\supply/pCapexTrajectoriesDefault.csv
    --pCSPData C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\supply/pCSPData.csv
    --pFuelPrice C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\supply/pFuelPrice.csv
    --pVREgenProfile C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\supply/pVREgenProfile.csv
    --pVREProfile C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\supply/pVREProfile.csv
    --pStorageDataInput C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\supply/pStorageDataInput.csv
    --pPlanningReserveMargin C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\reserve/pPlanningReserveMargin.csv
    --pSpinningReserveReqCountry C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\reserve/pSpinningReserveReqCountry.csv
    --pSpinningReserveReqSystem C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\reserve/pSpinningReserveReqSystem.csv
    --pEmissionsTotal C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\constraint/pEmissionsTotal.csv
    --pEmissionsCountry C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\constraint/pEmissionsCountry.csv
    --pMaxFuellimit C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\constraint/pMaxFuellimit.csv
    --pCarbonPrice C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\constraint/pCarbonPrice.csv
    --zext C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\trade/zext.csv
    --pExtTransferLimit C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\trade/pExtTransferLimit.csv
    --pLossFactorInternal C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\trade/pLossFactorInternal.csv
    --pMaxPriceImportShare C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\trade/pMaxPriceImportShare.csv
    --pMaxAnnualExternalTradeShare C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\trade/pMaxAnnualExternalTradeShare.csv
    --pMinImport C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\trade/pMinImport.csv
    --pNewTransmission C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\trade/pNewTransmission.csv
    --pTradePrice C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\trade/pTradePrice.csv
    --pTransferLimit C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\trade/pTransferLimit.csv
    --pH2DataExcel C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\h2/pH2DataExcel.csv
    --pAvailabilityH2 C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\h2/pAvailabilityH2.csv
    --pCapexTrajectoryH2 C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\h2/pCapexTrajectoryH2.csv
    --pExternalH2 C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\h2/pExternalH2.csv
    --pFuelDataH2 C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test\h2/pFuelDataH2.csv
Licensee: Medium MUD - 10 User License                   G251002+0003Cc-GEN
          The World Bank, Energy Sector Management Assistance PrograDC12370
          C:\Users\wb590499\OneDrive - WBG\Documents\GAMS\gamslice.txt
          v:2                                                              
          The maintenance period of the license will expire on Dec 31, 2025
System information: 12 physical cores and 32 Gb physical memory detected
GAMS 50.1.0   Copyright (C) 1987-2025 GAMS Development. All rights reserved
--- Starting compilation
FOLDER_INPUT is "C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test"
LOG: Solving with MODELTYPE = "RMIP"
CPLEXFILE is "C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test/cplex/cplex_baseline.opt"
--- main.gms(66) 2 Mb
--- call rm -f cplex.opt
--- main.gms(67) 2 Mb
--- call cp "C:\Users\wb590499\Documents\Projects\EPM\epm\input\data_test/cplex/cplex_baseline.opt" cplex.opt
BASE_FILE is "C:\Users\wb590499\Documents\Projects\EPM\epm\base.gms"
REPORT_FILE is "C:\Users\wb590499\Documents\Projects\EPM\epm\generate_report.gms"
READER_FILE is "C:\Users\wb590499\Documents\Projects\EPM\epm\input_readers.gms"
DEMAND_FILE is "C:\Users\wb590499\Documents\Projects\EPM\epm\generate_demand.gms"
HYDROGEN_FILE is "C:\Users\wb590499\Documents\Projects\EPM\epm\hydrogen_module.gms"
--- main.gms(246) 4 Mb
### reading using Connect and CSV Input with Python
--- . input_readers.gms(637) 4 Mb
--- Initialize embedded library embconnectcclib64.dll
--- Execute embedded library embconnectcclib64.dll

--- main.gms(249) 4 Mb
--- GDXin=C:\Users\wb590499\Documents\Projects\EPM\epm\output\sensitivity_run_20251217_131040\baseline\input.gdx
--- GDX File ($gdxIn) C:\Users\wb590499\Documents\Projects\EPM\epm\output\sensitivity_run_20251217_131040\baseline\input.gdx
##########################
### INPUT VERIFICATION ###
##########################
--- main.gms(302) 5 Mb
--- Initialize embedded library embpycclib64.dll
--- Execute embedded library embpycclib64.dll
Warning: fEnableInternalExchange=0 disables internal exchanges.
Success: All values pHours positive.
Success: The sum of pHours is exactly 8760.
Success: All pVREProfile values are valid.
Success: All pAvailability values are valid.
Success: All dataframes have the same (q, d, t) combinations.
Unexpected error when checking pDemandForecast
  File "<string>", line 10, in <module>
  File "C:\Users\wb590499\Documents\Projects\EPM\epm\input_verification.py", line 1007, in run_input_verification_from_gdx
    return _run_input_verification_on_container(
  File "C:\Users\wb590499\Documents\Projects\EPM\epm\input_verification.py", line 100, in _run_input_verification_on_container
    run_input_verification(dummy_gams)
  File "C:\Users\wb590499\Documents\Projects\EPM\epm\input_verification.py", line 70, in run_input_verification
    _check_demand_forecast(gams, db)
  File "C:\Users\wb590499\Documents\Projects\EPM\epm\input_verification.py", line 469, in _check_demand_forecast
    df_pivot = records.pivot(index=["z", "y"], columns="pe", values="value").reset_index()
  File "C:\GAMS\50\GMSPython\Lib\site-packages\pandas\core\frame.py", line 9333, in pivot
    return pivot(self, index=index, columns=columns, values=values)
  File "C:\GAMS\50\GMSPython\Lib\site-packages\pandas\core\reshape\pivot.py", line 547, in pivot
    index_list = [data[idx] for idx in com.convert_to_list_like(index)]
  File "C:\GAMS\50\GMSPython\Lib\site-packages\pandas\core\frame.py", line 4096, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\GAMS\50\GMSPython\Lib\site-packages\pandas\core\indexes\base.py", line 3806, in get_loc
    raise KeyError(key) from err
Exception from Python (line 10): <class 'KeyError'>: 'z'
*** Error executing embedded code section:
*** Check log above
--- main.gms(302) 5 Mb 1 Error
*** Error 865 in C:\Users\wb590499\Documents\Projects\EPM\epm\main.gms
    Problem in embedded code section
***
*** Abort PythonError in input_verification.py
***
*** Error 343 in C:\Users\wb590499\Documents\Projects\EPM\epm\main.gms
    Abort triggered by above statement
--- main.gms(305) 5 Mb 2 Errors
*** Status: Compilation error(s)
--- Job main.gms Stop 12/17/25 13:11:03 elapsed 0:00:16.779

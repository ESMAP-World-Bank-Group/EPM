
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Hydro Availability Builder &#8212; Energy Planning Model</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../../_static/styles/bootstrap.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=796348d33e8b1d947c94" rel="stylesheet">
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=4ec06e9971c5264fbd345897d5258098f11cc577" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94">
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=8bf782fb4ee92b3d3646425e50f299c4e1fd152d"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'pre-analysis/prepare-data/hydro_availability';</script>
    <link rel="canonical" href="https://github.com/ESMAP-World-Bank-Group/EPM/pre-analysis/prepare-data/hydro_availability.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Supply-demand balance" href="supply_demand_balance.html" />
    <link rel="prev" title="Demand Forecast Plots" href="load_plot.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../../home.html">

  
  
  
  
  
  
  

  
    <img src="../../_static/esmap.png" class="logo__image only-light" alt="Logo image">
    <img src="../../_static/esmap.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  
  <div class="col-lg-9 navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/introduction.html">
                        About EPM
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/introduction_case_studies.html">
                        EPM Recent Case Studies
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/run_folder_structure.html">
                        EPM Folder structure
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/run_prerequisites.html">
                        Prerequisites: Install Required Tools
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/run_installation.html">
                        EPM Installation Guide
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/run_gams_studio.html">
                        Run EPM from GAMS Studio
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/run_python.html">
                        Run EPM from Python
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/run_python_advanced.html">
                        Run EPM from Python - Advanced Features
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/run_python_summary.html">
                        Run EPM with Python - Summary
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/run_remote_server.html">
                        Run EPM on the Remote Server
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/run_git_process.html">
                        Git Procedure for Beginners
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/run_epm_setup.html">
                        EPM Code Set Up
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/run_debugging.html">
                        Debugging EPM Models in GAMS
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/run_troubleshooting.html">
                        Common Issues & Troubleshooting
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/run_summary.html">
                        Summary Command line
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/options_solver.html">
                        Solver Options for EPM
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/options_thread.html">
                        Threading and Parallelism in EPM
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/input_structure.html">
                        Input Folder Structure
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/input_overview.html">
                        Input Overview
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/input_detailed.html">
                        Input Description
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/input_set_definition.html">
                        Set definition
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/input_from_excel_to_csv.html">
                        Transitioning from Excel to CSV
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/input_technology_brief.html">
                        Technology Overview
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/input_fuel_brief.html">
                        Fuel Overview
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/input_representative_days.html">
                        Representative Days
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/postprocessing_output_EPM.html">
                        EPM Output Overview
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/postprocessing_output.html">
                        Output Folder Structure
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/postprocessing_output_overview.html">
                        Postprocessing Output Overview
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/postprocessing_tableau.html">
                        Tableau Workflow
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/postprocessing_tableau_advanced.html">
                        Tableau Advanced Tutorial: How to modify Tableau visualization
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/model_overview.html">
                        Mathematical Formulation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/model_description.html">
                        Model Description
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/model_notations.html">
                        Notations
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/model_formulation.html">
                        Model Formulation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/advanced_python.html">
                        Advanced Use of the Python API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/postprocessing.html">
                        Postprocessing with Python
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/contributing_code.html">
                        Contributing to the code
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/contributing_docs.html">
                        Contributing to the documentation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/contributing_postprocess.html">
                        Contributing postprocess
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/pre_overview.html">
                        Preanalysis Folder Overview
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/pre_projects.html">
                        Data Preparation Workflow Documentation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="climatic_overview.html">
                        Climatic Overview
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../open-data/get_renewables_coordinate.html">
                        Get Renewables Coordinates
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="load_plot.html">
                        Demand Forecast Plots
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="#">
                        Hydro Availability Builder
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="supply_demand_balance.html">
                        Supply-demand balance
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="representative_days/representative_days.html">
                        Representative Days for EPM
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/other_open_data.html">
                        Open-Source Data (in progress)
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/other_process.html">
                        Electricity Planning Standard Process
                      </a>
                    </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      
        <div class="navbar-end-item navbar-persistent--container">
          
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
        </div>
      
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>


  
  
    <div class="navbar-persistent--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
    </div>
  

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/introduction.html">
                        About EPM
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/introduction_case_studies.html">
                        EPM Recent Case Studies
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/run_folder_structure.html">
                        EPM Folder structure
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/run_prerequisites.html">
                        Prerequisites: Install Required Tools
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/run_installation.html">
                        EPM Installation Guide
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/run_gams_studio.html">
                        Run EPM from GAMS Studio
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/run_python.html">
                        Run EPM from Python
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/run_python_advanced.html">
                        Run EPM from Python - Advanced Features
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/run_python_summary.html">
                        Run EPM with Python - Summary
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/run_remote_server.html">
                        Run EPM on the Remote Server
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/run_git_process.html">
                        Git Procedure for Beginners
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/run_epm_setup.html">
                        EPM Code Set Up
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/run_debugging.html">
                        Debugging EPM Models in GAMS
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/run_troubleshooting.html">
                        Common Issues & Troubleshooting
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/run_summary.html">
                        Summary Command line
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/options_solver.html">
                        Solver Options for EPM
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/options_thread.html">
                        Threading and Parallelism in EPM
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/input_structure.html">
                        Input Folder Structure
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/input_overview.html">
                        Input Overview
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/input_detailed.html">
                        Input Description
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/input_set_definition.html">
                        Set definition
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/input_from_excel_to_csv.html">
                        Transitioning from Excel to CSV
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/input_technology_brief.html">
                        Technology Overview
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/input_fuel_brief.html">
                        Fuel Overview
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/input_representative_days.html">
                        Representative Days
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/postprocessing_output_EPM.html">
                        EPM Output Overview
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/postprocessing_output.html">
                        Output Folder Structure
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/postprocessing_output_overview.html">
                        Postprocessing Output Overview
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/postprocessing_tableau.html">
                        Tableau Workflow
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/postprocessing_tableau_advanced.html">
                        Tableau Advanced Tutorial: How to modify Tableau visualization
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/model_overview.html">
                        Mathematical Formulation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/model_description.html">
                        Model Description
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/model_notations.html">
                        Notations
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/model_formulation.html">
                        Model Formulation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/advanced_python.html">
                        Advanced Use of the Python API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/postprocessing.html">
                        Postprocessing with Python
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/contributing_code.html">
                        Contributing to the code
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/contributing_docs.html">
                        Contributing to the documentation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/contributing_postprocess.html">
                        Contributing postprocess
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/pre_overview.html">
                        Preanalysis Folder Overview
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/pre_projects.html">
                        Data Preparation Workflow Documentation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="climatic_overview.html">
                        Climatic Overview
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../open-data/get_renewables_coordinate.html">
                        Get Renewables Coordinates
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="load_plot.html">
                        Demand Forecast Plots
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="#">
                        Hydro Availability Builder
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="supply_demand_balance.html">
                        Supply-demand balance
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="representative_days/representative_days.html">
                        Representative Days for EPM
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/other_open_data.html">
                        Open-Source Data (in progress)
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/other_process.html">
                        Electricity Planning Standard Process
                      </a>
                    </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
    
  </div>

  
  <div class="sidebar-start-items sidebar-primary__section">
    <div class="sidebar-start-items__item">
  


<a class="navbar-brand logo" href="../../home.html">

  
  
  
  
  
  
  

  
    <img src="../../_static/esmap.png" class="logo__image only-light" alt="Logo image">
    <img src="../../_static/esmap.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    </div>
    <div class="sidebar-start-items__item">
<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
    <div class="sidebar-start-items__item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../docs/introduction.html">About EPM</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../docs/introduction_case_studies.html">EPM Recent Case Studies</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Run EPM</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../docs/run_folder_structure.html">EPM Folder structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/run_prerequisites.html">Prerequisites: Install Required Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/run_installation.html">EPM Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/run_gams_studio.html">Run EPM from GAMS Studio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/run_python.html">Run EPM from Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/run_python_advanced.html">Run EPM from Python - Advanced Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/run_python_summary.html">Run EPM with Python - Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/run_remote_server.html">Run EPM on the Remote Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/run_git_process.html">Git Procedure for Beginners</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/run_epm_setup.html">EPM Code Set Up</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/run_debugging.html">Debugging EPM Models in GAMS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/run_troubleshooting.html">Common Issues &amp; Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/run_summary.html">Summary Command line</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Run Options</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../docs/options_solver.html">Solver Options for EPM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/options_thread.html">Threading and Parallelism in EPM</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Input</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../docs/input_structure.html">Input Folder Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/input_overview.html">Input Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/input_detailed.html">Input Description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/input_set_definition.html">Set definition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/input_from_excel_to_csv.html">Transitioning from Excel to CSV</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/input_technology_brief.html">Technology Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/input_fuel_brief.html">Fuel Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/input_representative_days.html">Representative Days</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Output &amp; Postprocessing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../docs/postprocessing_output_EPM.html">EPM Output Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/postprocessing_output.html">Output Folder Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/postprocessing_output_overview.html">Postprocessing Output Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/postprocessing_tableau.html">Tableau Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/postprocessing_tableau_advanced.html">Tableau Advanced Tutorial: How to modify Tableau visualization</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Model Description</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../docs/model_overview.html">Mathematical Formulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/model_description.html">Model Description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/model_notations.html">Notations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/model_formulation.html">Model Formulation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Advanced Topics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../docs/advanced_python.html">Advanced Use of the Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/postprocessing.html">Postprocessing with Python</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../docs/contributing_code.html">Contributing to the code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/contributing_docs.html">Contributing to the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/contributing_postprocess.html">Contributing postprocess</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Pre-processing Analysis</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../docs/pre_overview.html">Preanalysis Folder Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/pre_projects.html">Data Preparation Workflow Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="climatic_overview.html">Climatic Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../open-data/get_renewables_coordinate.html">Get Renewables Coordinates</a></li>
<li class="toctree-l1"><a class="reference internal" href="load_plot.html">Demand Forecast Plots</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Hydro Availability Builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="supply_demand_balance.html">Supply-demand balance</a></li>
<li class="toctree-l1"><a class="reference internal" href="representative_days/representative_days.html">Representative Days for EPM</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Other Resources</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../docs/other_open_data.html">Open-Source Data (in progress)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/other_process.html">Electricity Planning Standard Process</a></li>
</ul>

    </div>
</nav>
    </div>
  </div>
  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

  
  <div id="rtd-footer-container"></div>

      </div>
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        <label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" data-toggle="tooltip" data-placement="right" title="Toggle primary sidebar">
            <span class="fa-solid fa-bars"></span>
        </label>
    </div>
    <div class="header-article__right">


<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
  </ul>
</div>

<button onclick="toggleFullScreen()"
  class="btn btn-sm"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<div class="dropdown dropdown-repository-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      <li><a href="https://github.com/ESMAP-World-Bank-Group/EPM" target="_blank"
   class="btn btn-sm dropdown-item"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">repository</span>
</a>
</a>
      
      <li><a href="https://github.com/ESMAP-World-Bank-Group/EPM/issues/new?title=Issue%20on%20page%20%2Fpre-analysis/prepare-data/hydro_availability.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm dropdown-item"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">open issue</span>
</a>
</a>
      
      <li><a href="https://github.com/ESMAP-World-Bank-Group/EPM/edit/main/pre-analysis/prepare-data/hydro_availability.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">suggest edit</span>
</a>
</a>
      
  </ul>
</div>



<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      <li><a href="../../_sources/pre-analysis/prepare-data/hydro_availability.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</a>
      
      <li>
<button onclick="printPdf(this)"
  class="btn btn-sm dropdown-item"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</a>
      
  </ul>
</div>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary" data-toggle="tooltip" data-placement="left" title="Toggle secondary sidebar">
            <span class="fa-solid fa-list"></span>
        </label>
    </div>
</div>
            </div>
            
            

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Hydro Availability Builder</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#user-inputs">
   1. User Inputs
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup-imports-folders-and-helpers">
   2. Setup: imports, folders, and helpers
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-hydro-profiles-and-the-phours-template">
   3. Load hydro profiles and the pHours template
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#validate-generators-against-pgendatainput">
   4. Validate generators against
   <code class="docutils literal notranslate">
    <span class="pre">
     pGenDataInput
    </span>
   </code>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-build-zone-average-placeholders-for-missing-generators">
     4b - Build zone-average placeholders for missing generators
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#c-completed-hydro-capacity-factor-profile-and-qa-plots">
     4c - Completed hydro capacity-factor profile and QA plots
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#process-hydro-availability">
   5 - Process hydro availability
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-build-seasonal-reservoir-availability">
     5a - Build seasonal reservoir availability
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-format-run-of-river-hourly-availability">
     5b - Format run-of-river hourly availability
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>

            <article class="bd-article" role="main">
              
  <section class="tex2jax_ignore mathjax_ignore" id="hydro-availability-builder">
<h1>Hydro Availability Builder<a class="headerlink" href="#hydro-availability-builder" title="Permalink to this heading">#</a></h1>
<p><strong>Objective</strong></p>
<ul class="simple">
<li><p>Transform monthly reservoir and run-of-river (ROR) hydro profiles into the seasonal and hourly availability CSVs (<code class="docutils literal notranslate"><span class="pre">pAvailabilityCustom.csv</span></code> and <code class="docutils literal notranslate"><span class="pre">pVREgenProfile.csv</span></code>) required by EPM.</p></li>
<li><p>Ensure consistency with pGenDataInput and complete if necessary.</p></li>
</ul>
<p><strong>Data requirements (user-provided) and method</strong></p>
<ul class="simple">
<li><p>Data requirements: Monthly capacity-factor CSVs per plant/zone (default <code class="docutils literal notranslate"><span class="pre">input/hydro_profile_dry.csv</span></code>), plant metadata fields (<code class="docutils literal notranslate"><span class="pre">gen</span></code>, <code class="docutils literal notranslate"><span class="pre">zone</span></code>, <code class="docutils literal notranslate"><span class="pre">tech</span></code>), and the official <code class="docutils literal notranslate"><span class="pre">pHours.csv</span></code> template from <code class="docutils literal notranslate"><span class="pre">epm/input/</span></code> to align the season-daytype-hour structure.</p></li>
<li><p>Method: Validate inputs, align them with the <code class="docutils literal notranslate"><span class="pre">pHours</span></code> calendar, aggregate reservoir series to seasonal capacity factors, reshape ROR series into the long hourly format, and export review-ready CSVs.</p></li>
</ul>
<p><strong>Overview of steps</strong></p>
<ol class="arabic simple">
<li><p>Step 1 - Capture the user inputs describing folders, scenario tags, and technology filters.</p></li>
<li><p>Step 2 - Create the working/output folders and load the template layout.</p></li>
<li><p>Step 3 - Load the hydro profiles plus the <code class="docutils literal notranslate"><span class="pre">pHours</span></code> calendar.</p></li>
<li><p>Step 4 - Cross-check hydro coverage against <code class="docutils literal notranslate"><span class="pre">pGenDataInput</span></code> to flag missing capacity-factor rows.</p></li>
<li><p>Step 5 - Process reservoir and ROR data into the <code class="docutils literal notranslate"><span class="pre">pAvailabilityCustom</span></code> and <code class="docutils literal notranslate"><span class="pre">pVREgenProfile</span></code> tables, then save them for QA.</p></li>
</ol>
<section id="user-inputs">
<h2>1. User Inputs<a class="headerlink" href="#user-inputs" title="Permalink to this heading">#</a></h2>
<p>Fill these once and rerun if you need to change the source data or template. Files are resolved relative to <code class="docutils literal notranslate"><span class="pre">pre-analysis/prepare-data/</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Path to the monthly hydro profile CSV stored under `input/`</span>
<span class="n">input_profile_filename</span> <span class="o">=</span> <span class="s1">&#39;hydro_profile_baseline.csv&#39;</span>

<span class="c1"># Folder under `epm/input/` containing the scenario-specific inputs</span>
<span class="n">folder_epm_input</span> <span class="o">=</span> <span class="s1">&#39;data_capp&#39;</span>

<span class="c1"># Filenames relative to `epm/input/&lt;folder_epm_input&gt;/`</span>
<span class="n">hours_template_filename</span> <span class="o">=</span> <span class="s1">&#39;pHours.csv&#39;</span>
<span class="n">pGenDataInput_filename</span> <span class="o">=</span> <span class="s1">&#39;pGenDataInput.csv&#39;</span>

<span class="c1"># Optional: list the zones to process (e.g. [&#39;Angola&#39;, &#39;Cameroon&#39;]). Leave empty to include every zone found in the hydro profile.</span>
<span class="n">zones</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Angola&#39;</span><span class="p">,</span> <span class="s1">&#39;Cameroon&#39;</span><span class="p">,</span> <span class="s1">&#39;CAR&#39;</span><span class="p">,</span> <span class="s1">&#39;Chad&#39;</span><span class="p">,</span> <span class="s1">&#39;Congo&#39;</span><span class="p">,</span> <span class="s1">&#39;DRC&#39;</span><span class="p">,</span> <span class="s1">&#39;EquatorialGuinea&#39;</span><span class="p">,</span> <span class="s1">&#39;Gabon&#39;</span><span class="p">,</span> <span class="s1">&#39;DRC_South&#39;</span><span class="p">]</span>

<span class="c1"># Month to season to consier</span>
<span class="n">MONTH_TO_SEASON</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span>
    <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span>
    <span class="mi">7</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span>
    <span class="mi">10</span><span class="p">:</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="setup-imports-folders-and-helpers">
<h2>2. Setup: imports, folders, and helpers<a class="headerlink" href="#setup-imports-folders-and-helpers" title="Permalink to this heading">#</a></h2>
<p>Run once to load libraries and create the working folders referenced later in the notebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">folder_input</span> <span class="o">=</span> <span class="s1">&#39;input&#39;</span>
<span class="n">folder_output</span> <span class="o">=</span> <span class="s1">&#39;output&#39;</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">folder_output</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Input folder: </span><span class="si">{</span><span class="n">folder_input</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Output folder: </span><span class="si">{</span><span class="n">folder_output</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input folder: input
Output folder: output
</pre></div>
</div>
</div>
</div>
</section>
<section id="load-hydro-profiles-and-the-phours-template">
<h2>3. Load hydro profiles and the pHours template<a class="headerlink" href="#load-hydro-profiles-and-the-phours-template" title="Permalink to this heading">#</a></h2>
<p>Validates the user inputs, loads the monthly hydro profiles, and reads the pHours layout that drives the seasonal/daytype structure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">input_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">folder_input</span><span class="p">)</span> <span class="o">/</span> <span class="n">input_profile_filename</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">input_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
    <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cannot find </span><span class="si">{</span><span class="n">input_path</span><span class="si">}</span><span class="s1">. Double-check `input_profile_filename`.&#39;</span><span class="p">)</span>

<span class="n">hydro_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">input_path</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin1&#39;</span><span class="p">)</span> <span class="c1"># latin1 #utf-8-sig</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;gen&#39;</span><span class="p">,</span> <span class="s1">&#39;zone&#39;</span><span class="p">,</span> <span class="s1">&#39;tech&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">hydro_data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">hydro_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">hydro_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

<span class="n">zone_candidates</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zones</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
    <span class="n">zone_candidates</span> <span class="o">=</span> <span class="p">[</span><span class="n">chunk</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">zones</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">chunk</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span>
<span class="k">elif</span> <span class="n">zones</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">zone_candidates</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">iterator</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">zones</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="n">zone_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">zones</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">zone_candidates</span> <span class="o">=</span> <span class="p">[</span><span class="n">zone_str</span><span class="p">]</span> <span class="k">if</span> <span class="n">zone_str</span> <span class="k">else</span> <span class="p">[]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">zone_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">zone_str</span><span class="p">:</span>
                <span class="n">zone_candidates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zone_str</span><span class="p">)</span>

<span class="n">available_zones</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">hydro_data</span><span class="p">[</span><span class="s1">&#39;zone&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="k">if</span> <span class="n">zone_candidates</span><span class="p">:</span>
    <span class="n">missing_zones</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">zone_candidates</span><span class="p">)</span> <span class="o">-</span> <span class="n">available_zones</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">missing_zones</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: the following zones are not present in </span><span class="si">{</span><span class="n">input_path</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> and will be ignored: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">missing_zones</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">hydro_data</span> <span class="o">=</span> <span class="n">hydro_data</span><span class="p">[</span><span class="n">hydro_data</span><span class="p">[</span><span class="s1">&#39;zone&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">zone_candidates</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">hydro_data</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;No hydro rows remain after applying the `zones` filter. Update `zones` to match the data.&#39;</span><span class="p">)</span>

<span class="n">selected_zones</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">hydro_data</span><span class="p">[</span><span class="s1">&#39;zone&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">selected_zones</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;No valid zone entries found in the hydro profile. Ensure the `zone` column is populated.&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">zone_candidates</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Filtering hydro profile to </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">selected_zones</span><span class="p">)</span><span class="si">}</span><span class="s2"> zone(s): </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">selected_zones</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No `zones` filter supplied; using all </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">selected_zones</span><span class="p">)</span><span class="si">}</span><span class="s2"> zone(s): </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">selected_zones</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">value_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">hydro_data</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;gen&#39;</span><span class="p">,</span> <span class="s1">&#39;zone&#39;</span><span class="p">,</span> <span class="s1">&#39;tech&#39;</span><span class="p">)]</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">value_columns</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;The hydro profile file does not contain any monthly capacity-factor columns.&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Loaded hydro profile: </span><span class="si">{</span><span class="n">input_path</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">hydro_data</span><span class="p">)</span><span class="si">}</span><span class="s1"> rows after filtering&#39;</span><span class="p">)</span>

<span class="n">epm_input_root</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;../../epm/input&#39;</span><span class="p">)</span>
<span class="n">hours_template_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">epm_input_root</span><span class="p">),</span> <span class="n">folder_epm_input</span><span class="p">,</span> <span class="n">hours_template_filename</span><span class="p">))</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">hours_template_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
    <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cannot find </span><span class="si">{</span><span class="n">hours_template_file</span><span class="si">}</span><span class="s1">. Update `hours_template_filename` or `folder_epm_input`.&#39;</span><span class="p">)</span>

<span class="n">template</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">hours_template_file</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Loaded pHours template from </span><span class="si">{</span><span class="n">hours_template_file</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">pGenDataInput_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">epm_input_root</span><span class="p">),</span> <span class="n">folder_epm_input</span><span class="p">,</span> <span class="s1">&#39;supply&#39;</span><span class="p">,</span> <span class="n">pGenDataInput_filename</span><span class="p">))</span>
<span class="k">if</span> <span class="n">pGenDataInput_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s1">&#39;Cannot find pGenDataInput in the scenario folder (checked root and `supply/`).&#39;</span><span class="p">)</span>

<span class="n">pgen_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">pGenDataInput_file</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8-sig&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;gen&#39;</span><span class="p">,</span> <span class="s1">&#39;zone&#39;</span><span class="p">,</span> <span class="s1">&#39;tech&#39;</span><span class="p">,</span> <span class="s1">&#39;fuel&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">pgen_data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">pgen_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">pgen_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Loaded pGenDataInput from </span><span class="si">{</span><span class="n">pGenDataInput_file</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning: the following zones are not present in hydro_profile_baseline.csv and will be ignored: Chad
Filtering hydro profile to 8 zone(s): Angola, CAR, Cameroon, Congo, DRC, DRC_South, EquatorialGuinea, Gabon
Loaded hydro profile: hydro_profile_baseline.csv with 97 rows after filtering
Loaded pHours template from ../../epm/input/data_capp/pHours.csv
Loaded pGenDataInput from ../../epm/input/data_capp/supply/pGenDataInput.csv
</pre></div>
</div>
</div>
</div>
</section>
<section id="validate-generators-against-pgendatainput">
<h2>4. Validate generators against <code class="docutils literal notranslate"><span class="pre">pGenDataInput</span></code><a class="headerlink" href="#validate-generators-against-pgendatainput" title="Permalink to this heading">#</a></h2>
<p>Compare the hydro units included in the monthly capacity-factor file with those defined in <code class="docutils literal notranslate"><span class="pre">pGenDataInput</span></code> so any gaps can be filled before exporting the availability tables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">profile_gens</span> <span class="o">=</span> <span class="n">hydro_data</span><span class="p">[</span><span class="s1">&#39;gen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="n">profile_gen_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">profile_gens</span><span class="p">)</span>
<span class="n">profile_zone_lookup</span> <span class="o">=</span> <span class="n">hydro_data</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">gen</span><span class="o">=</span><span class="n">profile_gens</span><span class="p">,</span> <span class="n">zone</span><span class="o">=</span><span class="n">hydro_data</span><span class="p">[</span><span class="s1">&#39;zone&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;gen&#39;</span><span class="p">)[</span><span class="s1">&#39;zone&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>

<span class="n">hydro_mask</span> <span class="o">=</span> <span class="n">pgen_data</span><span class="p">[</span><span class="s1">&#39;fuel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;Water&#39;</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">*</span> <span class="n">pgen_data</span><span class="p">[</span><span class="s1">&#39;Status&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">pgen_hydro</span> <span class="o">=</span> <span class="n">pgen_data</span><span class="p">[</span><span class="n">hydro_mask</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">pgen_hydro</span><span class="p">[</span><span class="s1">&#39;gen&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pgen_hydro</span><span class="p">[</span><span class="s1">&#39;gen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="n">pgen_hydro</span><span class="p">[</span><span class="s1">&#39;zone&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pgen_hydro</span><span class="p">[</span><span class="s1">&#39;zone&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="n">selected_zone_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">selected_zones</span><span class="p">)</span> <span class="k">if</span> <span class="s1">&#39;selected_zones&#39;</span> <span class="ow">in</span> <span class="nb">globals</span><span class="p">()</span> <span class="k">else</span> <span class="nb">set</span><span class="p">()</span>
<span class="k">if</span> <span class="n">selected_zone_set</span><span class="p">:</span>
    <span class="n">pgen_hydro</span> <span class="o">=</span> <span class="n">pgen_hydro</span><span class="p">[</span><span class="n">pgen_hydro</span><span class="p">[</span><span class="s1">&#39;zone&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">selected_zone_set</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">pgen_gen_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">pgen_hydro</span><span class="p">[</span><span class="s1">&#39;gen&#39;</span><span class="p">])</span>
<span class="n">zone_lookup</span> <span class="o">=</span> <span class="n">pgen_hydro</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;gen&#39;</span><span class="p">)[</span><span class="s1">&#39;zone&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>

<span class="n">missing_profiles</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">pgen_gen_set</span> <span class="o">-</span> <span class="n">profile_gen_set</span><span class="p">)</span>
<span class="n">missing_in_pgen</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">profile_gen_set</span> <span class="o">-</span> <span class="n">pgen_gen_set</span><span class="p">)</span>

<span class="n">zone_peer_map</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">hydro_data</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">gen</span><span class="o">=</span><span class="n">profile_gens</span><span class="p">,</span> <span class="n">zone</span><span class="o">=</span><span class="n">hydro_data</span><span class="p">[</span><span class="s1">&#39;zone&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
        <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;zone&#39;</span><span class="p">)[</span><span class="s1">&#39;gen&#39;</span><span class="p">]</span>
        <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>
        <span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<span class="p">)</span>

<span class="n">numeric_matrix</span> <span class="o">=</span> <span class="n">hydro_data</span><span class="p">[[</span><span class="s1">&#39;zone&#39;</span><span class="p">,</span> <span class="s1">&#39;gen&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">numeric_matrix</span><span class="p">[</span><span class="s1">&#39;tech&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hydro_data</span><span class="p">[</span><span class="s1">&#39;tech&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">value_columns</span><span class="p">:</span>
    <span class="n">numeric_matrix</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">hydro_data</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>

<span class="n">zone_cf_template</span> <span class="o">=</span> <span class="n">numeric_matrix</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;zone&#39;</span><span class="p">)[</span><span class="n">value_columns</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">zone_tech_cf_template</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">numeric_matrix</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tech&#39;</span><span class="p">])</span>
        <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;zone&#39;</span><span class="p">,</span> <span class="s1">&#39;tech&#39;</span><span class="p">])[</span><span class="n">value_columns</span><span class="p">]</span>
        <span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">zone_avg_cf</span> <span class="o">=</span> <span class="n">zone_cf_template</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<span class="n">zone_tech_avg_cf</span> <span class="o">=</span> <span class="n">zone_tech_cf_template</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>

<span class="k">if</span> <span class="n">missing_profiles</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">missing_profiles</span><span class="p">)</span><span class="si">}</span><span class="s2"> hydro generators are defined in pGenDataInput but missing capacity-factor profiles:&quot;</span><span class="p">)</span>
    <span class="n">impacted_zones</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">gen</span> <span class="ow">in</span> <span class="n">missing_profiles</span><span class="p">:</span>
        <span class="n">zone</span> <span class="o">=</span> <span class="n">zone_lookup</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">gen</span><span class="p">,</span> <span class="s1">&#39;Unknown&#39;</span><span class="p">)</span>
        <span class="n">impacted_zones</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">zone</span><span class="p">)</span>
        <span class="n">peers</span> <span class="o">=</span> <span class="p">[</span><span class="n">peer</span> <span class="k">for</span> <span class="n">peer</span> <span class="ow">in</span> <span class="n">zone_peer_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">zone</span><span class="p">,</span> <span class="p">[])</span> <span class="k">if</span> <span class="n">peer</span> <span class="o">!=</span> <span class="n">gen</span><span class="p">]</span>
        <span class="n">tech</span> <span class="o">=</span> <span class="s1">&#39;Unknown&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;tech&#39;</span> <span class="ow">in</span> <span class="n">pgen_hydro</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">tech</span> <span class="o">=</span> <span class="n">pgen_hydro</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">pgen_hydro</span><span class="p">[</span><span class="s1">&#39;gen&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">gen</span><span class="p">,</span> <span class="s1">&#39;tech&#39;</span><span class="p">]</span>
            <span class="n">tech</span> <span class="o">=</span> <span class="n">tech</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">tech</span><span class="o">.</span><span class="n">empty</span> <span class="k">else</span> <span class="s1">&#39;Unknown&#39;</span>
        <span class="n">avg_cf</span> <span class="o">=</span> <span class="n">zone_tech_avg_cf</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="n">zone</span><span class="p">,</span> <span class="n">tech</span><span class="p">))</span>
        <span class="n">avg_source</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;zone </span><span class="si">{</span><span class="n">zone</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">tech</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">avg_cf</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">avg_source</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">avg_cf</span> <span class="o">=</span> <span class="n">zone_avg_cf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">zone</span><span class="p">)</span>
            <span class="n">avg_source</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;zone </span><span class="si">{</span><span class="n">zone</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">peers</span> <span class="ow">and</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">avg_cf</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  - </span><span class="si">{</span><span class="n">gen</span><span class="si">}</span><span class="s2"> (zone </span><span class="si">{</span><span class="n">zone</span><span class="si">}</span><span class="s2">, tech </span><span class="si">{</span><span class="n">tech</span><span class="si">}</span><span class="s2">): add values by averaging existing hydro in </span><span class="si">{</span><span class="n">avg_source</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">peers</span><span class="p">)</span><span class="si">}</span><span class="s2">)  suggested mean CF </span><span class="si">{</span><span class="n">avg_cf</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  - </span><span class="si">{</span><span class="n">gen</span><span class="si">}</span><span class="s2"> (zone </span><span class="si">{</span><span class="n">zone</span><span class="si">}</span><span class="s2">, tech </span><span class="si">{</span><span class="n">tech</span><span class="si">}</span><span class="s2">): no peer hydro available; please enter CFs manually.&quot;</span><span class="p">)</span>
    <span class="n">available_zones</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">zone</span> <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="n">impacted_zones</span> <span class="k">if</span> <span class="n">zone</span> <span class="ow">in</span> <span class="n">zone_cf_template</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">available_zones</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Zone-average monthly profiles for the impacted zones:&#39;</span><span class="p">)</span>
        <span class="n">display</span><span class="p">(</span><span class="n">zone_cf_template</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">available_zones</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;All hydro generators in pGenDataInput have matching capacity-factor profiles.&#39;</span><span class="p">)</span>



<span class="k">if</span> <span class="n">missing_in_pgen</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">missing_in_pgen</span><span class="p">)</span><span class="si">}</span><span class="s2"> generators have capacity-factor rows here but are missing from pGenDataInput:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">gen</span> <span class="ow">in</span> <span class="n">missing_in_pgen</span><span class="p">:</span>
        <span class="n">zone</span> <span class="o">=</span> <span class="n">profile_zone_lookup</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">gen</span><span class="p">,</span> <span class="s1">&#39;Unknown&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  - </span><span class="si">{</span><span class="n">gen</span><span class="si">}</span><span class="s2"> (zone </span><span class="si">{</span><span class="n">zone</span><span class="si">}</span><span class="s2">): either remove it from the hydro profile or add the unit to pGenDataInput so EPM can use it.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No extra hydro capacity-factor rows beyond what pGenDataInput expects.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>13 hydro generators are defined in pGenDataInput but missing capacity-factor profiles:
  - Bikomo (zone EquatorialGuinea, tech ROR): add values by averaging existing hydro in zone EquatorialGuinea (Djibloho, Djibloho 2, Sendje)  suggested mean CF 0.517.
  - Bongolo (zone Gabon, tech ReservoirHydro): add values by averaging existing hydro in zone Gabon (ReservoirHydro) (Boou, Chute de Tsamba, Chutes de l&#39;Imperatrice, Defile de Mitoungou, Dibwangui, FE-2 (Kinguele Aval), Grand Poubara, Kinguele, Kongue, Kouata Mango, Lifouta, Ngoulmendjim, Poubara, Tchimbele, Tsengue Leledi)  suggested mean CF 0.524.
  - Booue (zone Gabon, tech ReservoirHydro): add values by averaging existing hydro in zone Gabon (ReservoirHydro) (Boou, Chute de Tsamba, Chutes de l&#39;Imperatrice, Defile de Mitoungou, Dibwangui, FE-2 (Kinguele Aval), Grand Poubara, Kinguele, Kongue, Kouata Mango, Lifouta, Ngoulmendjim, Poubara, Tchimbele, Tsengue Leledi)  suggested mean CF 0.524.
  - Bousanga (zone DRC_South, tech ReservoirHydro): add values by averaging existing hydro in zone DRC_South (ReservoirHydro) (Koni, Mwadingusha, Nseke, Nzilo, Nzilo 2)  suggested mean CF 0.649.
  - Kilubi (zone DRC_South, tech ReservoirHydro): add values by averaging existing hydro in zone DRC_South (ReservoirHydro) (Koni, Mwadingusha, Nseke, Nzilo, Nzilo 2)  suggested mean CF 0.649.
  - Mitoungou (zone Gabon, tech ReservoirHydro): add values by averaging existing hydro in zone Gabon (ReservoirHydro) (Boou, Chute de Tsamba, Chutes de l&#39;Imperatrice, Defile de Mitoungou, Dibwangui, FE-2 (Kinguele Aval), Grand Poubara, Kinguele, Kongue, Kouata Mango, Lifouta, Ngoulmendjim, Poubara, Tchimbele, Tsengue Leledi)  suggested mean CF 0.524.
  - Moukouloukou (zone Congo, tech ReservoirHydro): add values by averaging existing hydro in zone Congo (ReservoirHydro) (Chollet (Cameroon), Chollet (Congo), Djoue Rebuild, Imboulou, Kouembali, Liouesso, Moukoukoulou, Mourala, Mpoukou, Nyanga, Sounda Gorge)  suggested mean CF 0.453.
  - Nzongo (zone DRC, tech ReservoirHydro): add values by averaging existing hydro in zone DRC (ReservoirHydro) (Bendera, Inga, Inga 1, Inga 2, Inga 3, Kakobola, Katende, Kimbombo, Mambilima I, Mambilima II, Mambilima V, Mbamba, Mobayi, Mumbotuta CX, Mumbotuta M, Portes d&#39;enfer, Sanga, Sombwe, Totshi, Ubangui, Wanie Rukula, Zongo 1, Zongo 2)  suggested mean CF 0.560.
  - Nzongoii (zone DRC, tech ReservoirHydro): add values by averaging existing hydro in zone DRC (ReservoirHydro) (Bendera, Inga, Inga 1, Inga 2, Inga 3, Kakobola, Katende, Kimbombo, Mambilima I, Mambilima II, Mambilima V, Mbamba, Mobayi, Mumbotuta CX, Mumbotuta M, Portes d&#39;enfer, Sanga, Sombwe, Totshi, Ubangui, Wanie Rukula, Zongo 1, Zongo 2)  suggested mean CF 0.560.
  - Nzoro (zone DRC, tech ReservoirHydro): add values by averaging existing hydro in zone DRC (ReservoirHydro) (Bendera, Inga, Inga 1, Inga 2, Inga 3, Kakobola, Katende, Kimbombo, Mambilima I, Mambilima II, Mambilima V, Mbamba, Mobayi, Mumbotuta CX, Mumbotuta M, Portes d&#39;enfer, Sanga, Sombwe, Totshi, Ubangui, Wanie Rukula, Zongo 1, Zongo 2)  suggested mean CF 0.560.
  - Quilengue (zone Angola, tech ROR): add values by averaging existing hydro in zone Angola (ROR) (AH Mabubas, Baynes, Cacula Cabasa, Cafula (Keve), Calengue (Catumbela), Cambambe, Capanda, Gove, Jamba Ya Mina, Jamba Ya Oma, Lauca, Lomaum, Lomaum 2, Luachimo, Matala, Quilengue (Balalunga), Tchiumbwe Dala, Tumuludo Casador, Vuka Hydropower, Zenzo Hydropower)  suggested mean CF 0.406.
  - Riaba (zone EquatorialGuinea, tech ROR): add values by averaging existing hydro in zone EquatorialGuinea (Djibloho, Djibloho 2, Sendje)  suggested mean CF 0.517.
  - Soleniama (zone DRC, tech ReservoirHydro): add values by averaging existing hydro in zone DRC (ReservoirHydro) (Bendera, Inga, Inga 1, Inga 2, Inga 3, Kakobola, Katende, Kimbombo, Mambilima I, Mambilima II, Mambilima V, Mbamba, Mobayi, Mumbotuta CX, Mumbotuta M, Portes d&#39;enfer, Sanga, Sombwe, Totshi, Ubangui, Wanie Rukula, Zongo 1, Zongo 2)  suggested mean CF 0.560.
Zone-average monthly profiles for the impacted zones:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
    </tr>
    <tr>
      <th>zone</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Angola</th>
      <td>0.627</td>
      <td>0.698</td>
      <td>0.868</td>
      <td>0.846</td>
      <td>0.526</td>
      <td>0.223</td>
      <td>0.118</td>
      <td>0.091</td>
      <td>0.099</td>
      <td>0.129</td>
      <td>0.278</td>
      <td>0.448</td>
    </tr>
    <tr>
      <th>Congo</th>
      <td>0.495</td>
      <td>0.521</td>
      <td>0.546</td>
      <td>0.571</td>
      <td>0.527</td>
      <td>0.354</td>
      <td>0.265</td>
      <td>0.224</td>
      <td>0.298</td>
      <td>0.384</td>
      <td>0.636</td>
      <td>0.615</td>
    </tr>
    <tr>
      <th>DRC</th>
      <td>0.673</td>
      <td>0.703</td>
      <td>0.813</td>
      <td>0.827</td>
      <td>0.771</td>
      <td>0.634</td>
      <td>0.550</td>
      <td>0.481</td>
      <td>0.474</td>
      <td>0.461</td>
      <td>0.550</td>
      <td>0.580</td>
    </tr>
    <tr>
      <th>DRC_South</th>
      <td>0.828</td>
      <td>0.980</td>
      <td>0.944</td>
      <td>0.880</td>
      <td>0.760</td>
      <td>0.700</td>
      <td>0.620</td>
      <td>0.560</td>
      <td>0.430</td>
      <td>0.400</td>
      <td>0.370</td>
      <td>0.320</td>
    </tr>
    <tr>
      <th>EquatorialGuinea</th>
      <td>0.350</td>
      <td>0.307</td>
      <td>0.320</td>
      <td>0.633</td>
      <td>0.697</td>
      <td>0.693</td>
      <td>0.327</td>
      <td>0.170</td>
      <td>0.497</td>
      <td>0.757</td>
      <td>0.757</td>
      <td>0.697</td>
    </tr>
    <tr>
      <th>Gabon</th>
      <td>0.547</td>
      <td>0.517</td>
      <td>0.519</td>
      <td>0.589</td>
      <td>0.587</td>
      <td>0.466</td>
      <td>0.333</td>
      <td>0.254</td>
      <td>0.389</td>
      <td>0.575</td>
      <td>0.770</td>
      <td>0.721</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19 generators have capacity-factor rows here but are missing from pGenDataInput:
  - Bac + Lotomo (zone CAR): either remove it from the hydro profile or add the unit to pGenDataInput so EPM can use it.
  - Bendera (zone DRC): either remove it from the hydro profile or add the unit to pGenDataInput so EPM can use it.
  - Boou (zone Gabon): either remove it from the hydro profile or add the unit to pGenDataInput so EPM can use it.
  - Defile de Mitoungou (zone Gabon): either remove it from the hydro profile or add the unit to pGenDataInput so EPM can use it.
  - Djibloho 2 (zone EquatorialGuinea): either remove it from the hydro profile or add the unit to pGenDataInput so EPM can use it.
  - Djoue Rebuild (zone Congo): either remove it from the hydro profile or add the unit to pGenDataInput so EPM can use it.
  - Inga (zone DRC): either remove it from the hydro profile or add the unit to pGenDataInput so EPM can use it.
  - Kimbombo (zone DRC): either remove it from the hydro profile or add the unit to pGenDataInput so EPM can use it.
  - Mambilima I (zone DRC): either remove it from the hydro profile or add the unit to pGenDataInput so EPM can use it.
  - Mambilima II (zone DRC): either remove it from the hydro profile or add the unit to pGenDataInput so EPM can use it.
  - Mambilima V (zone DRC): either remove it from the hydro profile or add the unit to pGenDataInput so EPM can use it.
  - Mbamba (zone DRC): either remove it from the hydro profile or add the unit to pGenDataInput so EPM can use it.
  - Moukoukoulou (zone Congo): either remove it from the hydro profile or add the unit to pGenDataInput so EPM can use it.
  - Mumbotuta CX (zone DRC): either remove it from the hydro profile or add the unit to pGenDataInput so EPM can use it.
  - Mumbotuta M (zone DRC): either remove it from the hydro profile or add the unit to pGenDataInput so EPM can use it.
  - Nzilo 2 (zone DRC_South): either remove it from the hydro profile or add the unit to pGenDataInput so EPM can use it.
  - Portes d&#39;enfer (zone DRC): either remove it from the hydro profile or add the unit to pGenDataInput so EPM can use it.
  - Quilengue (Balalunga) (zone Angola): either remove it from the hydro profile or add the unit to pGenDataInput so EPM can use it.
  - Totshi (zone DRC): either remove it from the hydro profile or add the unit to pGenDataInput so EPM can use it.
</pre></div>
</div>
</div>
</div>
<section id="b-build-zone-average-placeholders-for-missing-generators">
<h3>4b - Build zone-average placeholders for missing generators<a class="headerlink" href="#b-build-zone-average-placeholders-for-missing-generators" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Build placeholder monthly capacity-factor profiles for generators missing in the hydro file.</span>
<span class="n">derived_cf_profiles</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;gen&#39;</span><span class="p">,</span> <span class="s1">&#39;zone&#39;</span><span class="p">,</span> <span class="s1">&#39;tech&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">value_columns</span><span class="p">])</span>
<span class="k">if</span> <span class="n">missing_profiles</span><span class="p">:</span>
    <span class="n">tech_lookup</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pgen_hydro</span><span class="o">.</span><span class="n">empty</span> <span class="ow">and</span> <span class="s1">&#39;tech&#39;</span> <span class="ow">in</span> <span class="n">pgen_hydro</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">tech_lookup</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">pgen_hydro</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">tech</span><span class="o">=</span><span class="n">pgen_hydro</span><span class="p">[</span><span class="s1">&#39;tech&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
            <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;gen&#39;</span><span class="p">)[</span><span class="s1">&#39;tech&#39;</span><span class="p">]</span>
            <span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
        <span class="p">)</span>

    <span class="n">fill_rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">skipped_missing</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">gen</span> <span class="ow">in</span> <span class="n">missing_profiles</span><span class="p">:</span>
        <span class="n">zone</span> <span class="o">=</span> <span class="n">zone_lookup</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">gen</span><span class="p">,</span> <span class="s1">&#39;Unknown&#39;</span><span class="p">)</span>
        <span class="n">tech</span> <span class="o">=</span> <span class="n">tech_lookup</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">gen</span><span class="p">,</span> <span class="s1">&#39;Unknown&#39;</span><span class="p">)</span>
        <span class="n">template_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">zone</span><span class="p">,</span> <span class="n">tech</span><span class="p">)</span>
        <span class="n">zone_profile</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">template_key</span> <span class="ow">in</span> <span class="n">zone_tech_cf_template</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="n">zone_profile</span> <span class="o">=</span> <span class="n">zone_tech_cf_template</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">template_key</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">zone</span> <span class="ow">in</span> <span class="n">zone_cf_template</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="n">zone_profile</span> <span class="o">=</span> <span class="n">zone_cf_template</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">zone</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">zone_profile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">skipped_missing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="n">row</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;gen&#39;</span><span class="p">:</span> <span class="n">gen</span><span class="p">,</span>
            <span class="s1">&#39;zone&#39;</span><span class="p">:</span> <span class="n">zone</span><span class="p">,</span>
            <span class="s1">&#39;tech&#39;</span><span class="p">:</span> <span class="n">tech</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">value_columns</span><span class="p">:</span>
            <span class="n">row</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">zone_profile</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
        <span class="n">fill_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">fill_rows</span><span class="p">:</span>
        <span class="n">derived_cf_profiles</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">fill_rows</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;gen&#39;</span><span class="p">,</span> <span class="s1">&#39;zone&#39;</span><span class="p">,</span> <span class="s1">&#39;tech&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">value_columns</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Prepared placeholders for </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">derived_cf_profiles</span><span class="p">)</span><span class="si">}</span><span class="s1"> generator(s) using zone/technology averages.&#39;</span><span class="p">)</span>
        <span class="n">display</span><span class="p">(</span><span class="n">derived_cf_profiles</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Missing generators detected but no zone or zone-tech averages available to build placeholders.&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">skipped_missing</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Skipped generators without valid averages:&#39;</span><span class="p">,</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">skipped_missing</span><span class="p">))</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No missing hydro generators -&gt; placeholder DataFrame empty.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Prepared placeholders for 13 generator(s) using zone/technology averages.
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gen</th>
      <th>zone</th>
      <th>tech</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Bikomo</td>
      <td>EquatorialGuinea</td>
      <td>ROR</td>
      <td>0.350000</td>
      <td>0.306667</td>
      <td>0.320000</td>
      <td>0.633333</td>
      <td>0.696667</td>
      <td>0.693333</td>
      <td>0.326667</td>
      <td>0.170000</td>
      <td>0.496667</td>
      <td>0.756667</td>
      <td>0.756667</td>
      <td>0.696667</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bongolo</td>
      <td>Gabon</td>
      <td>ReservoirHydro</td>
      <td>0.536667</td>
      <td>0.491667</td>
      <td>0.490833</td>
      <td>0.578333</td>
      <td>0.580000</td>
      <td>0.487500</td>
      <td>0.350833</td>
      <td>0.265833</td>
      <td>0.439167</td>
      <td>0.610833</td>
      <td>0.750000</td>
      <td>0.707500</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Booue</td>
      <td>Gabon</td>
      <td>ReservoirHydro</td>
      <td>0.536667</td>
      <td>0.491667</td>
      <td>0.490833</td>
      <td>0.578333</td>
      <td>0.580000</td>
      <td>0.487500</td>
      <td>0.350833</td>
      <td>0.265833</td>
      <td>0.439167</td>
      <td>0.610833</td>
      <td>0.750000</td>
      <td>0.707500</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Bousanga</td>
      <td>DRC_South</td>
      <td>ReservoirHydro</td>
      <td>0.828000</td>
      <td>0.980000</td>
      <td>0.944000</td>
      <td>0.880000</td>
      <td>0.760000</td>
      <td>0.700000</td>
      <td>0.620000</td>
      <td>0.560000</td>
      <td>0.430000</td>
      <td>0.400000</td>
      <td>0.370000</td>
      <td>0.320000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Kilubi</td>
      <td>DRC_South</td>
      <td>ReservoirHydro</td>
      <td>0.828000</td>
      <td>0.980000</td>
      <td>0.944000</td>
      <td>0.880000</td>
      <td>0.760000</td>
      <td>0.700000</td>
      <td>0.620000</td>
      <td>0.560000</td>
      <td>0.430000</td>
      <td>0.400000</td>
      <td>0.370000</td>
      <td>0.320000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="c-completed-hydro-capacity-factor-profile-and-qa-plots">
<h3>4c - Completed hydro capacity-factor profile and QA plots<a class="headerlink" href="#c-completed-hydro-capacity-factor-profile-and-qa-plots" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Combine the original hydro profiles with any derived zone-average placeholders.</span>
<span class="n">cf_profile_completed</span> <span class="o">=</span> <span class="n">hydro_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">derived_cf_profiles</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
    <span class="n">cf_profile_completed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">hydro_data</span><span class="p">,</span> <span class="n">derived_cf_profiles</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">cf_profile_completed</span><span class="p">[</span><span class="n">value_columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">cf_profile_completed</span><span class="p">[</span><span class="n">value_columns</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
<span class="n">cf_profile_completed</span> <span class="o">=</span> <span class="n">cf_profile_completed</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;gen&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;zone&#39;</span><span class="p">,</span> <span class="s1">&#39;gen&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Completed capacity-factor table contains </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">cf_profile_completed</span><span class="p">)</span><span class="si">}</span><span class="s2"> generator rows across </span><span class="si">{</span><span class="n">cf_profile_completed</span><span class="p">[</span><span class="s1">&#39;zone&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">}</span><span class="s2"> zone(s).&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">cf_profile_completed</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="n">completed_gen_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">cf_profile_completed</span><span class="p">[</span><span class="s1">&#39;gen&#39;</span><span class="p">])</span>
<span class="n">remaining_missing</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">pgen_gen_set</span> <span class="o">-</span> <span class="n">completed_gen_set</span><span class="p">)</span>
<span class="k">if</span> <span class="n">remaining_missing</span><span class="p">:</span>
    <span class="n">preview</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">remaining_missing</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>
    <span class="n">more</span> <span class="o">=</span> <span class="s1">&#39;...&#39;</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">remaining_missing</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Still missing </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">remaining_missing</span><span class="p">)</span><span class="si">}</span><span class="s2"> generator(s) after filling: </span><span class="si">{</span><span class="n">preview</span><span class="si">}{</span><span class="n">more</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;All hydro generators defined in pGenDataInput now have capacity-factor rows.&#39;</span><span class="p">)</span>


<span class="c1"># Plot monthly capacity factors with zone/technology averages.</span>
<span class="n">zones_to_plot</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">cf_profile_completed</span><span class="p">[</span><span class="s1">&#39;zone&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="n">tech_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ReservoirHydro&#39;</span><span class="p">,</span> <span class="s1">&#39;ROR&#39;</span><span class="p">]</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">zones_to_plot</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No zones available for plotting capacity-factor profiles.&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">zones_to_plot</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">tech_columns</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">tech_columns</span><span class="p">),</span> <span class="mf">3.2</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">zones_to_plot</span><span class="p">)),</span> <span class="n">squeeze</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">legend_drawn</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">for</span> <span class="n">row_idx</span><span class="p">,</span> <span class="n">zone</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">zones_to_plot</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">col_idx</span><span class="p">,</span> <span class="n">tech</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tech_columns</span><span class="p">):</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">row_idx</span><span class="p">][</span><span class="n">col_idx</span><span class="p">]</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">cf_profile_completed</span><span class="p">[</span><span class="s1">&#39;zone&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">zone</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">cf_profile_completed</span><span class="p">[</span><span class="s1">&#39;tech&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">tech</span><span class="p">)</span>
            <span class="n">zone_tech_df</span> <span class="o">=</span> <span class="n">cf_profile_completed</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">zone_tech_df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">zone</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">tech</span><span class="si">}</span><span class="s2">(no data)&quot;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;No data&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.4&#39;</span><span class="p">)</span>
                <span class="k">continue</span>

            <span class="n">zone_values</span> <span class="o">=</span> <span class="n">zone_tech_df</span><span class="p">[</span><span class="n">value_columns</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">zone_values</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">value_columns</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.7&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

            <span class="n">zone_avg</span> <span class="o">=</span> <span class="n">zone_values</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">value_columns</span><span class="p">,</span> <span class="n">zone_avg</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Zone-tech average&#39;</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">zone</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">tech</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">zone_tech_df</span><span class="p">)</span><span class="si">}</span><span class="s2"> gens)&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">value_columns</span><span class="p">)))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">value_columns</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Capacity factor&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">legend_drawn</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
                <span class="n">legend_drawn</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Completed capacity-factor table contains 110 generator rows across 8 zone(s).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>zone</th>
      <th>gen</th>
      <th>tech</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Angola</td>
      <td>AH Mabubas</td>
      <td>ROR</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>0.22</td>
      <td>0.06</td>
      <td>0.02</td>
      <td>0.01</td>
      <td>0.01</td>
      <td>0.02</td>
      <td>0.08</td>
      <td>0.58</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Angola</td>
      <td>Baynes</td>
      <td>ReservoirHydro</td>
      <td>0.33</td>
      <td>0.23</td>
      <td>0.4</td>
      <td>0.77</td>
      <td>0.79</td>
      <td>0.34</td>
      <td>0.29</td>
      <td>0.20</td>
      <td>0.11</td>
      <td>0.06</td>
      <td>0.09</td>
      <td>0.30</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Angola</td>
      <td>Cacula Cabasa</td>
      <td>ROR</td>
      <td>0.51</td>
      <td>0.76</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>0.76</td>
      <td>0.13</td>
      <td>0.02</td>
      <td>0.01</td>
      <td>0.02</td>
      <td>0.07</td>
      <td>0.57</td>
      <td>0.30</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Angola</td>
      <td>Cafula (Keve)</td>
      <td>ROR</td>
      <td>0.84</td>
      <td>0.67</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>0.25</td>
      <td>0.05</td>
      <td>0.01</td>
      <td>0.01</td>
      <td>0.01</td>
      <td>0.07</td>
      <td>0.22</td>
      <td>0.74</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Angola</td>
      <td>Calengue (Catumbela)</td>
      <td>ROR</td>
      <td>0.51</td>
      <td>0.76</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>0.76</td>
      <td>0.13</td>
      <td>0.02</td>
      <td>0.01</td>
      <td>0.02</td>
      <td>0.07</td>
      <td>0.57</td>
      <td>0.30</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>All hydro generators defined in pGenDataInput now have capacity-factor rows.
</pre></div>
</div>
<img alt="../../_images/a31a112fa32bcdd30130f6ed791ae7c738f85eb31a5c2462b04d48d9cc096596.png" src="../../_images/a31a112fa32bcdd30130f6ed791ae7c738f85eb31a5c2462b04d48d9cc096596.png" />
</div>
</div>
</section>
</section>
<section id="process-hydro-availability">
<h2>5 - Process hydro availability<a class="headerlink" href="#process-hydro-availability" title="Permalink to this heading">#</a></h2>
<section id="a-build-seasonal-reservoir-availability">
<h3>5a - Build seasonal reservoir availability<a class="headerlink" href="#a-build-seasonal-reservoir-availability" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Keep only Reservoir Hydro units and the monthly columns.</span>
<span class="n">data_reservoir</span> <span class="o">=</span> <span class="n">cf_profile_completed</span><span class="p">[</span><span class="n">cf_profile_completed</span><span class="p">[</span><span class="s1">&#39;tech&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ReservoirHydro&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">data_reservoir</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;gen&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data_reservoir</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;zone&#39;</span><span class="p">,</span> <span class="s1">&#39;tech&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data_reservoir</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">data_reservoir</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">data_reservoir</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># Convert months to seasons using MONTH_TO_SEASON and compute the mean for each season.</span>
<span class="n">data_reservoir</span> <span class="o">=</span> <span class="n">data_reservoir</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">MONTH_TO_SEASON</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>

<span class="c1"># Rename the season columns with the expected Q prefix and persist the output.</span>
<span class="n">data_reservoir</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Q</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data_reservoir</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
<span class="n">data_reservoir</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;season&#39;</span><span class="p">]</span>
<span class="n">display</span><span class="p">(</span><span class="n">data_reservoir</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="n">output_path_reservoir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder_output</span><span class="p">,</span> <span class="s1">&#39;pAvailabilityCustom.csv&#39;</span><span class="p">)</span>
<span class="n">data_reservoir</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_path_reservoir</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reservoir data processed and saved to </span><span class="si">{</span><span class="n">output_path_reservoir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
    </tr>
    <tr>
      <th>gen</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Baynes</th>
      <td>0.33</td>
      <td>0.23</td>
      <td>0.40</td>
      <td>0.77</td>
      <td>0.79</td>
      <td>0.34</td>
      <td>0.29</td>
      <td>0.20</td>
      <td>0.11</td>
      <td>0.06</td>
      <td>0.09</td>
      <td>0.30</td>
    </tr>
    <tr>
      <th>Cambambe</th>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.33</td>
      <td>0.05</td>
      <td>0.02</td>
      <td>0.01</td>
      <td>0.03</td>
      <td>0.15</td>
      <td>0.61</td>
    </tr>
    <tr>
      <th>Capanda</th>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.35</td>
      <td>0.06</td>
      <td>0.03</td>
      <td>0.02</td>
      <td>0.06</td>
      <td>0.23</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>Gove</th>
      <td>0.64</td>
      <td>0.61</td>
      <td>0.71</td>
      <td>0.72</td>
      <td>0.47</td>
      <td>0.29</td>
      <td>0.19</td>
      <td>0.13</td>
      <td>0.10</td>
      <td>0.06</td>
      <td>0.14</td>
      <td>0.16</td>
    </tr>
    <tr>
      <th>Bac + Lotomo</th>
      <td>0.56</td>
      <td>0.52</td>
      <td>0.52</td>
      <td>0.52</td>
      <td>0.54</td>
      <td>0.57</td>
      <td>0.61</td>
      <td>0.72</td>
      <td>0.91</td>
      <td>0.99</td>
      <td>0.90</td>
      <td>0.64</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>season</th>
      <th>Q1</th>
      <th>Q2</th>
    </tr>
    <tr>
      <th>gen</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Baynes</th>
      <td>0.346</td>
      <td>0.311429</td>
    </tr>
    <tr>
      <th>Cambambe</th>
      <td>0.282</td>
      <td>0.684286</td>
    </tr>
    <tr>
      <th>Capanda</th>
      <td>0.292</td>
      <td>0.755714</td>
    </tr>
    <tr>
      <th>Gove</th>
      <td>0.236</td>
      <td>0.434286</td>
    </tr>
    <tr>
      <th>Bac + Lotomo</th>
      <td>0.670</td>
      <td>0.664286</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Reservoir data processed and saved to output/pAvailabilityCustom.csv
</pre></div>
</div>
</div>
</div>
</section>
<section id="b-format-run-of-river-hourly-availability">
<h3>5b - Format run-of-river hourly availability<a class="headerlink" href="#b-format-run-of-river-hourly-availability" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">build_ror_generation_profile</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">template</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Build the long-run hourly ROR profile expected by pVREgenProfile.csv.&quot;&quot;&quot;</span>

    <span class="c1"># Flatten the seasonal input and broadcast each value across the template&#39;s hours.</span>
    <span class="n">result_reset</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">result_long</span> <span class="o">=</span> <span class="n">result_reset</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s1">&#39;gen&#39;</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;season&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>

    <span class="n">template_pairs</span> <span class="o">=</span> <span class="n">template</span><span class="p">[[</span><span class="s1">&#39;season&#39;</span><span class="p">,</span> <span class="s1">&#39;daytype&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">merged</span> <span class="o">=</span> <span class="n">result_long</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">template_pairs</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;season&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">merged</span><span class="p">[</span><span class="s1">&#39;daytype&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="n">missing_seasons</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">merged</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">merged</span><span class="p">[</span><span class="s1">&#39;daytype&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">(),</span> <span class="s1">&#39;season&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()))</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Template is missing daytype definitions for: </span><span class="si">{</span><span class="n">missing_seasons</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">hour_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">template</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;season&#39;</span><span class="p">,</span> <span class="s1">&#39;daytype&#39;</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">hour_cols</span><span class="p">:</span>
        <span class="n">merged</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>

    <span class="n">merged_final</span> <span class="o">=</span> <span class="n">merged</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>
    <span class="n">ordered_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;gen&#39;</span><span class="p">,</span> <span class="s1">&#39;season&#39;</span><span class="p">,</span> <span class="s1">&#39;daytype&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">hour_cols</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">merged_final</span><span class="p">[</span><span class="n">ordered_cols</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filter to Run-of-River units and retain monthly columns only.</span>
<span class="n">data_ror</span> <span class="o">=</span> <span class="n">cf_profile_completed</span><span class="p">[</span><span class="n">cf_profile_completed</span><span class="p">[</span><span class="s1">&#39;tech&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ROR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">if</span> <span class="n">data_ror</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No ROR generators found. Skipping pVREgenProfile export.&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">data_ror</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;gen&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">data_ror</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;zone&#39;</span><span class="p">,</span> <span class="s1">&#39;tech&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">data_ror</span><span class="p">[</span><span class="n">value_columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_ror</span><span class="p">[</span><span class="n">value_columns</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
    <span class="n">data_ror</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">data_ror</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">data_ror</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

    <span class="c1"># Convert months to seasons and label them with the Q prefix.</span>
    <span class="n">data_ror</span> <span class="o">=</span> <span class="n">data_ror</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">MONTH_TO_SEASON</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
    <span class="n">display</span><span class="p">(</span><span class="n">data_ror</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
    <span class="n">data_ror</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Q</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data_ror</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
    <span class="n">data_ror</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;season&#39;</span><span class="p">]</span>

    <span class="c1"># Align with the template structure so downstream scripts can ingest the file directly.</span>
    <span class="n">data_ror</span> <span class="o">=</span> <span class="n">build_ror_generation_profile</span><span class="p">(</span><span class="n">data_ror</span><span class="p">,</span> <span class="n">template</span><span class="p">)</span>
    <span class="n">column_order</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;gen&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">template</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()]</span>
    <span class="n">data_ror</span> <span class="o">=</span> <span class="n">data_ror</span><span class="p">[</span><span class="n">column_order</span><span class="p">]</span>
    <span class="n">display</span><span class="p">(</span><span class="n">data_ror</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

    <span class="n">output_path_ror</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder_output</span><span class="p">,</span> <span class="s1">&#39;pVREgenProfile.csv&#39;</span><span class="p">)</span>
    <span class="n">data_ror</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_path_ror</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ROR data processed and saved to </span><span class="si">{</span><span class="n">output_path_ror</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
    </tr>
    <tr>
      <th>gen</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AH Mabubas</th>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.22</td>
      <td>0.06</td>
      <td>0.02</td>
      <td>0.01</td>
      <td>0.01</td>
      <td>0.02</td>
      <td>0.08</td>
      <td>0.58</td>
    </tr>
    <tr>
      <th>Cacula Cabasa</th>
      <td>0.51</td>
      <td>0.76</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.76</td>
      <td>0.13</td>
      <td>0.02</td>
      <td>0.01</td>
      <td>0.02</td>
      <td>0.07</td>
      <td>0.57</td>
      <td>0.30</td>
    </tr>
    <tr>
      <th>Cafula (Keve)</th>
      <td>0.84</td>
      <td>0.67</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.25</td>
      <td>0.05</td>
      <td>0.01</td>
      <td>0.01</td>
      <td>0.01</td>
      <td>0.07</td>
      <td>0.22</td>
      <td>0.74</td>
    </tr>
    <tr>
      <th>Calengue (Catumbela)</th>
      <td>0.51</td>
      <td>0.76</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.76</td>
      <td>0.13</td>
      <td>0.02</td>
      <td>0.01</td>
      <td>0.02</td>
      <td>0.07</td>
      <td>0.57</td>
      <td>0.30</td>
    </tr>
    <tr>
      <th>Jamba Ya Mina</th>
      <td>0.19</td>
      <td>0.30</td>
      <td>0.64</td>
      <td>0.41</td>
      <td>0.20</td>
      <td>0.13</td>
      <td>0.10</td>
      <td>0.07</td>
      <td>0.05</td>
      <td>0.07</td>
      <td>0.14</td>
      <td>0.31</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
      <th>2</th>
    </tr>
    <tr>
      <th>gen</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AH Mabubas</th>
      <td>0.064</td>
      <td>0.668571</td>
    </tr>
    <tr>
      <th>Cacula Cabasa</th>
      <td>0.188</td>
      <td>0.601429</td>
    </tr>
    <tr>
      <th>Cafula (Keve)</th>
      <td>0.066</td>
      <td>0.648571</td>
    </tr>
    <tr>
      <th>Calengue (Catumbela)</th>
      <td>0.188</td>
      <td>0.601429</td>
    </tr>
    <tr>
      <th>Jamba Ya Mina</th>
      <td>0.110</td>
      <td>0.294286</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gen</th>
      <th>season</th>
      <th>daytype</th>
      <th>t1</th>
      <th>t2</th>
      <th>t3</th>
      <th>t4</th>
      <th>t5</th>
      <th>t6</th>
      <th>t7</th>
      <th>...</th>
      <th>t15</th>
      <th>t16</th>
      <th>t17</th>
      <th>t18</th>
      <th>t19</th>
      <th>t20</th>
      <th>t21</th>
      <th>t22</th>
      <th>t23</th>
      <th>t24</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AH Mabubas</td>
      <td>Q1</td>
      <td>d1</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>...</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AH Mabubas</td>
      <td>Q1</td>
      <td>d2</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>...</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AH Mabubas</td>
      <td>Q1</td>
      <td>d3</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>...</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AH Mabubas</td>
      <td>Q1</td>
      <td>d4</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>...</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AH Mabubas</td>
      <td>Q1</td>
      <td>d5</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>...</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
      <td>0.064</td>
    </tr>
  </tbody>
</table>
<p>5 rows  27 columns</p>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ROR data processed and saved to output/pVREgenProfile.csv
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./pre-analysis/prepare-data"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

            </article>
            

            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="load_plot.html" title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">Demand Forecast Plots</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="supply_demand_balance.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">Supply-demand balance</p>
  </div>
  <i class="fa-solid fa-angle-right"></i>
  </a>
</div>
            </footer>
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
</div>
<nav id="bd-toc-nav" class="page-toc">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#user-inputs">
   1. User Inputs
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup-imports-folders-and-helpers">
   2. Setup: imports, folders, and helpers
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-hydro-profiles-and-the-phours-template">
   3. Load hydro profiles and the pHours template
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#validate-generators-against-pgendatainput">
   4. Validate generators against
   <code class="docutils literal notranslate">
    <span class="pre">
     pGenDataInput
    </span>
   </code>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-build-zone-average-placeholders-for-missing-generators">
     4b - Build zone-average placeholders for missing generators
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#c-completed-hydro-capacity-factor-profile-and-qa-plots">
     4c - Completed hydro capacity-factor profile and QA plots
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#process-hydro-availability">
   5 - Process hydro availability
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-build-seasonal-reservoir-availability">
     5a - Build seasonal reservoir availability
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-format-run-of-river-hourly-availability">
     5b - Format run-of-river hourly availability
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By ESMAP
</p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    <p class="last-updated">
Last updated on Nov 26, 2025.<br>
</p>
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <div>Cite as: <i>"ESMAP Documentation - EPM. Available at https://github.com/ESMAP-World-Bank-Group/EPM"</i><br>
    <b>All content (unless otherwise specified) is subject to the <a href="https://raw.githubusercontent.com/worldbank/template/main/LICENSE">World Bank Master Community License Agreement.</a></b>
</div>

</div>
  </div>
  
</div>
          </div>
        </footer>
        

      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94"></script>

  </body>
</html>